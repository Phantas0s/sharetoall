image: php:7.2

services:
- name: mariadb:latest
  alias: db

variables:
  MYSQL_DATABASE: sharetoall
  MYSQL_USER: sharetoall
  MYSQL_PASSWORD: sharetoall
  MYSQL_HOST: db

before_script:
# Install dependencies
- bash ci/docker_install.sh > /dev/null
- echo "SELECT 'OK';" | mysql --user="${DB_USERNAME} --password="${MYSQL_ROOT_PASSWORD}" --host=mysql "${MYSQL_DATABASE}"

test:sharetoall:
  script:
  - bin/phing dev
  - phpunit --configuration phpunit.xml
